# @toktokhan-dev/cli-plugin-gen-api-react-query

## 0.0.14

### Patch Changes

- @toktokhan-dev/cli@0.0.8
- @toktokhan-dev/node@0.0.7

## 0.0.13

### Patch Changes

- @toktokhan-dev/cli@0.0.7
- @toktokhan-dev/node@0.0.6

## 0.0.12

### Patch Changes

- dfd9b18: fix fetch-type-template for pagination-option

  paginations 옵션이 paginationSets 로 변경됬지만, fetch 버젼 template 에는 반영되어있지 않아 발생한 버그가 수정되었습니다.

  ```ts
   paginationSets: [
      {
        keywords: ['cursor'],
        nextKey: 'cursor',
      },
    ],
  ```

## 0.0.11

### Patch Changes

- 4b535c5: paginations 으로 적용되어있는 곳을 수정했습니다.

## 0.0.10

### Patch Changes

- 2ec5863: cli 관련 네이밍 오타를 수정하였습니다.

  - paginations -> paginationSets
  - isOptialnalVariabels -> isOptionalVariables

## 0.0.9

### Patch Changes

- 0ff680a: generic type of custom-query-hooks

  useQuery 와 useInfiniteQuery 의 제너릭이 각각 바뀌어 들어가 있던 버그를 수정했습니다.

## 0.0.8

### Patch Changes

- 8f4874a: Instance Path & Comments & Query Key

  # Instance Path

  기존에 {name}.api.ts 파일에 에서 생성된 각 api class 의 instance 가
  {name}.query.ts 파일로 이동되었습니다.

  생성된 class 나 instance 를 axios instance 선언부애서 사용할 경우 해당 파일에서 instance 를 import 하고 있기 때문에 순환 참조가 일어납니다.

  위 버그를 방지하기위해 class api 선언부와 axios instance 를 import 하여 새로운 api instance 를 생성하는 로직을 다른 파일로 분리했습니다.

  #### 기존

  ```ts
  //Auth.api.ts

  import instance from '@/configs/axios/instance'

  export class AuthApi {
      ...
  }

  export const authApi = new AuthApi({ instance })
  ```

  ```ts
  // @/configs/axios/instance.ts

  import axios, { AxiosError } from 'axios';
  import { AuthApi, authApi } from '@/generated/swagger/Auth.api.ts'

  const instance = axios.create({...});

  const newAuthApi = new AuthApi({instance: axios.create()}) // Error - 순환 참조 발생

  instance.interceptors.request.use(
    (config) => {...},
    (error) => {...},
  );

  instance.interceptors.response.use(
    (res) => {...},
    async (error: AxiosError) => {
      ...
      authApi.refresh() // Error - 순환참조 발생

    },
  );

  export default instance;
  ```

  #### 변경

  ```ts
  // Auth.api.ts
  export class AuthApi {
      ...
  }
  // instance 선언부 제거
  ```

  ```ts
  // Auth.query.ts
  const authApi = new AuthApi({ instance })

  const AUTH_QUERY_KEY = {...}
  ```

  ```ts
  // @/configs/axios/instance.ts

  import axios, { AxiosError } from 'axios';
  import { AuthApi } from '@/generated/swagger/Auth.api.ts'

  const instance = axios.create({...});

  const authApi = new AuthApi({instance: axios.create()}) // no Error

  instance.interceptors.request.use(
    (config) => {...},
    (error) => {...},
  );

  instance.interceptors.response.use(
    (res) => {...},
    async (error: AxiosError) => {...},
  );

  export default instance;
  ```

  ## Query Key

  query key 의 정의 방식을 개선했습니다.

  ##### 기존

  ```ts
  {
    GET_LIST: (variables?: Parameter<typeof someApi.getList>) =>
      ['GET_LIST', variabels].filter((v) => typeof v !== 'undefined')
  }
  ```

  ##### 개선

  ```ts
  const isDefined = () => {...}

  {
    GET_LIST: (variables?: Parameter<typeof someApi.getList>) =>
      ['GET_LIST', variabels].filter(isDefined)
  }
  ```

  ## Comment

  아래 주석이 gen:api 가 생성하는 모든 파일에 추가되었습니다.

  ```
  /**
   * !DO NOT EDIT THIS FILE
   *
   * 스크립트가 실행될때, 파일을 항상 새로 쓰기 때문에 파일 수정시 작성내용이 제거 될 수 있습니다.
   */

  ```

  - @toktokhan-dev/cli@0.0.6
  - @toktokhan-dev/node@0.0.5

## 0.0.7

### Patch Changes

- Updated dependencies [b895311]
  - @toktokhan-dev/node@0.0.4
  - @toktokhan-dev/cli@0.0.5

## 0.0.6

### Patch Changes

- 3ec3add: infinite query generic

  select option 을 넘기지 않을 경우 잘못된 리턴 타입을 반환하는 버그를 수정했습니다.

  ```ts
  contractApi.businessContractBoardList// (arg) => Promise<SomeType>

  export const useSomeInfiniteQuery = <
    TData = RequestFnReturn<typeof contractApi.businessContractBoardList>
  >(
    params: InfiniteQueryHookParams<
      typeof contractApi.businessContractBoardList,
      AxiosError<any>,
      TData
    >,
  ) => {
    return useInfiniteQuery({...});
  };

  const { data } = useSomeIniniteQuery()

  console.log(data)
  // expect type : {pages: SomeType[], pageParams: [...]}
  // recivied type: SomeType
  ```

  생성되는 infiniteQuery hook 의 제너릭의 기본값이 수정 되었습니다.

  ```ts
  export const useSomeInfiniteQuery = <
    TData = InfiniteData<
      RequestFnReturn<typeof contractApi.businessContractTableList>,
      Parameter<typeof contractApi.businessContractTableList>
    >,
    >,
  >(
    params: InfiniteQueryHookParams<
      typeof contractApi.businessContractBoardList,
      AxiosError<any>,
      TData
    >,
  ) => {
    return useInfiniteQuery({...});
  };

  const { data } = useSomeIniniteQuery()

  console.log(data)
  // expect type : {pages: SomeType[], pageParams: [...]}
  // recivied type: {pages: SomeType[], pageParams: [...]}
  ```

## 0.0.5

### Patch Changes

- b854210: fix react query type

  '<' 와 같은 꺽쇠가 escape 처리 되는 이슈를 수정했습니다.

## 0.0.4

### Patch Changes

- @toktokhan-dev/cli@0.0.4
- @toktokhan-dev/node@0.0.3

## 0.0.3

### Patch Changes

- @toktokhan-dev/cli@0.0.3
- @toktokhan-dev/node@0.0.2

## 0.0.2

### Patch Changes

- Updated dependencies [515de8f]
  - @toktokhan-dev/cli@0.0.2

## 0.0.1

### Patch Changes

- eb93d14: 똑똑한개발자 공식 CLI 플러그인 입니다.
  자세한 설명은 [공식문서](https://toktokhan-dev-docs.vercel.app/docs/category/offical-plugins)를 참조해주세요.

  # Cli-plugin-gen-api-react-query

  Swagger 의 json 을 조회하여 타입정의와 api class, react-query 관련 모듈을 생성합니다. axios 를 사용하는 환경에서 사용가능합니다.

  # Cli-plugin-gen-icon-chakra

  지정된 경로의 svg파일 기반으로 Chakra UI Icon Component 를 생성합니다.

  # Cli-plugin-gen-img

  이미지 경로를 읽어 객체로 생성해줍니다.

  # Cli-plugin-gen-route-pages

  pages 폴더를 조회하여 route 경로를 포함한 객체를 생성합니다. next.js page router에서 사용가능합니다.

  # Cli-plugin-gen-sitemap-next-page

  next.js page router버전의 pages 폴더 기반으로 sitemap.xml 파일을 생성합니다.

  # Cli-plugin-gen-theme-chakra

  theme json 파일기반으로 Chakra theme token을 생성합니다.

- Updated dependencies [7f14e85]
- Updated dependencies [6c928f0]
  - @toktokhan-dev/cli@0.0.1
  - @toktokhan-dev/node@0.0.1

## 0.4.1

### Patch Changes

- Updated dependencies [0f43837]
  - @toktokhan-dev/node@2.0.0
  - @toktokhan-dev/cli@1.4.4

## 0.4.0

### Minor Changes

- 28c5efe: support http client for fetch

### Patch Changes

- be4a9cb: support http client for fetch

## 0.3.3

### Patch Changes

- Updated dependencies [bb60ca7]
  - @toktokhan-dev/node@1.3.1
  - @toktokhan-dev/cli@1.4.3

## 0.3.2

### Patch Changes

- 5b8176f: ignore sourcemap files
- Updated dependencies [5b8176f]
  - @toktokhan-dev/cli@1.4.2

## 0.3.1

### Patch Changes

- Updated dependencies [246b9a2]
  - @toktokhan-dev/cli@1.4.1

## 0.3.0

### Minor Changes

- 7baac8a: test version up

### Patch Changes

- Updated dependencies [7baac8a]
  - @toktokhan-dev/cli@1.4.0
  - @toktokhan-dev/node@1.3.0

## 0.2.1

### Patch Changes

- Updated dependencies [36d6b72]
  - @toktokhan-dev/cli@1.3.0

## 0.2.0

### Minor Changes

- ea08e81: update temp

### Patch Changes

- Updated dependencies [ea08e81]
  - @toktokhan-dev/cli@1.2.0
  - @toktokhan-dev/node@1.2.0

## 0.1.0

### Minor Changes

- b75ab4c: update

### Patch Changes

- Updated dependencies [b75ab4c]
  - @toktokhan-dev/cli@1.1.0
  - @toktokhan-dev/node@1.1.0

## 0.0.2

### Patch Changes

- Updated dependencies [c260db0]
  - @toktokhan-dev/node@1.0.1
  - @toktokhan-dev/cli@1.0.1
